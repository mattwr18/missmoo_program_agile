dist: xenial
language: ruby
rvm:
- 2.5.0
env:
- MOZ_HEADLESS=1
addons:
  firefox: latest
before_install:
- wget https://github.com/mozilla/geckodriver/releases/download/v0.20.1/geckodriver-v0.20.1-linux64.tar.gz
- mkdir geckodriver
- tar -xvf geckodriver-v0.20.1-linux64.tar.gz -C geckodriver
- export PATH=$PATH:$PWD/geckodriver
services:
- postgresql
before_script:
- psql -c 'create database travis_ci_test;' -U postgres
script:
- RAILS_ENV=test bundle exec rails db:migrate --trace
- bundle exec rails db:test:prepare
- bundle exec rspec spec/
- bundle exec rake assets:precompile
deploy:
  provider: heroku
  api_key:
    secure: PSWEhPlJbwgpq55C6O6qDpiHNrkf6OewjbZQ/LE1wC3PhsqFiepNx3O1rupJXuBfIdlvbgjYIHhn+D5YLQQYgJ4oOXvjceiN07Bjgm6a3FE+EtIBTttKXWw0QYLsGbk7+rdPM1T2YClYfkvxX5jmz/MOWBWIGLfdxYRu5metJEAslq3mEYcsc/0iDlRuwUTBSs+YDS6ArO3OHQGDMCb6tG43Mk7ZAlLgIzZEKnFB8goSyTePO6kOTM2sw+rA2HaZNMdSFm66USlCKSyFbMyoRpSStYf4eWSDwyK2B/eAUfw4JMCBsyyduKJB2ixtzuhPFbqZIdatd8YXc28qggyLI0AvDg6WXP+EvjJ55e9k/RV6jZttXcDJWhTyA2sMgMr1lzNv/LNxs1iRCnlHrhS+jsmaL5S7dRqdlvz5BS1cSULirD6Ws9kmvJhHhRavDXPzLFv87JZG2uuTyXZlyWIX9YOAc/qFCTasaZixPITWcUp9d733DBI1P06uX4j1RhV1IDyWSSslCRPFQsZZwiVRT6/NXWKi9KmYaVmHwIiWRngipzthYn94IqEa8DZq8ty1SkdgZWFSwF4NUZpLklN9aYORjQQOJDt3AB+JPBY6sKx2dGE4jax+71rgN4Tztg4yVj6qQsEodE9W9pLRqv94kEVEErYA/U2VvYLwaC7nx1A=
  run: rails db:migrate
  app: sme-organizer
  on:
    repo: mattwr18/sme-organizer
